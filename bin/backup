#!/bin/sh

# exit if any command fails
# set -eo pipefail ...why does that not work?
set -e

# @TODO test if storage drive is mounted &ifnot then:
####  mkdir /media/alec/storage
####  mount /dev/sdc1 /media/alec/storage
# https://www.tutorialspoint.com/how-to-mount-usb-drive-in-a-linux-system and 
# https://askubuntu.com/questions/285539/detect-and-mount-devices
# have some more info on working with devices

# @doc
# rsync -avvr source destination
# -a  archive mode
# -vv show verbose information about file transfers and skips
# -r  recursively copy subdirectories

#printf "Begin syncing www."
#rsync -avvr ~/www/ /media/alec/storage/www/
#printf "Done syncing www.\nNow sync accounting."

# ACCOUNTING
#rsync -avvr --exclude='*.sql' --exclude='*.tgz' --exclude='*.gz' --exclude='*.zip' /home/alec/accounting/ /media/alec/storage/accounting/
#printf "\nNow sync Webworks...\n"

# @TODO: rysnc breaks when filenames have `:` ???

# WORK
# rsync -avvr /home/alec/Webworks/ /media/alec/storage/Webworks
rsync -avvrz --exclude='*.sql' --exclude='*.tgz' --exclude='*.gz' --exclude='*.zip' ~/Work/ /media/alec/storage/Work/
printf "\nDone syncing Works.\nNow sync Documents...\n"

# DOCUMENTS
rsync -avvr --exclude='*.sql' --exclude='*.tgz' --exclude='*.gz' --exclude='*.zip' /home/alec/Documents/ /media/alec/storage/Documents/
printf "\nDone syncing documents.\n"

rsync -avvr /home/alec/.task/ /media/alec/storage/tasks/
printf "\nDone syncing tasks.\n"

rsync -avvr /home/alec/.timewarrior/ /media/alec/storage/time/
printf "\nDone syncing time.\n"

rsync -avvr --exclude='view' /home/alec/.dotfiles/ /media/alec/storage/dotfiles/
rsync -avvr --exclude='view' /home/alec/.config/ /media/alec/storage/config/
printf "\nDone syncing dotfiles and config.\n"

rsync -avvr /home/alec/.calendar/ /media/alec/storage/calendar/
printf "\nDone syncing calendar.\n"

rsync -avvr /home/alec/.password-store/ /media/alec/storage/.password-store/
printf "\nDone syncing passwords.\n"

rsync -avvr /home/alec/code/bin/ /media/alec/storage/code/bin/
rsync -avvr /home/alec/code/web/website-management-scripts/ /media/alec/storage/code/website-scripts/
rsync -avvr /home/alec/code/inc/ /media/alec/storage/code/inc/
printf "\nDone syncing code.\n"

rsync -avvr /home/alec/.ssh/ /media/alec/storage/ssh/
printf "\nDone syncing .ssh.\n"

rsync -avvr /home/alec/.fonts/ /media/alec/storage/fonts/
printf "\nDone syncing .fonts.\n"

# all important www projects should be stored on their own servers, dev branches pushed to remote.
# rsync -avvr --exclude='*.sql' --exclude='*.tgz' --exclude='*.gz' --exclude='*.zip' /home/alec/www/ /media/alec/storage/www

#rsync -avvr --exclude='*.sql' --exclude='*.tgz' --exclude='*.gz' --exclude='*.zip' --ignore-existing /home/alec/Pictures/ /media/alec/storage/Pictures/laptop-sync
#printf "\nDone syncing pictures.\n"
printf "Nothing else to sync, backup complete.\n"

# printf "Copy /var/www."
# tar -czvf /media/alec/storage/www.tgz /var/www
# printf "Extract www."
# cd /media/alec/storage
# tar -xvf www.tgz

#rsync -avvzP --exclude='*.sql' --exclude='*.tgz' --exclude='*.tar' --exclude='*.gz' --exclude='*.zip' --exclude='*.zip' /home/alec/Work/Clients /media/alec/storage/Webworks/Clients

